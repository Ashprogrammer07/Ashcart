{"ast":null,"code":"import{Fragment,useEffect,useMemo,useState}from\"react\";import{Button}from\"react-bootstrap\";import{useDispatch,useSelector}from\"react-redux\";import{toast}from\"react-toastify\";import MetaData from\"../layouts/MetaData\";import Loader from\"../layouts/loader\";import{MDBDataTable}from\"mdbreact\";import Sidebar from\"./sidebar\";import{deleteReview,getReviews}from\"../../actions/productsActions\";import{cleardeleteerror}from\"../../slices/userSlices\";// or productSlice if defined there\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function ReviewList(){const dispatch=useDispatch();const[productid,setproductid]=useState(\"\");const{reviews=[],loading,error,isreviewdeleted}=useSelector(state=>state.productState);console.log(reviews);// full object\nconst deleteHandler=(e,id)=>{e.target.disabled=true;dispatch(deleteReview(productid,id));};// Show error\nuseEffect(()=>{if(error){toast.error(error,{position:\"bottom-center\"});dispatch(cleardeleteerror());}},[error,dispatch]);// Show success message\nuseEffect(()=>{if(isreviewdeleted){toast.success(\"Review Deleted Successfully!\",{position:\"bottom-center\"});dispatch(cleardeleteerror());dispatch(getReviews(productid));// Refresh the reviews list\n}},[isreviewdeleted,dispatch,productid]);const onsubmithandler=e=>{e.preventDefault();// ✅ fixed typo here\nif(!productid.trim()){toast.warn(\"Please enter a product ID\",{position:\"bottom-center\"});return;}dispatch(getReviews(productid));};const data=useMemo(()=>{return{columns:[{label:\"ID\",field:\"id\",sort:\"asc\"},{label:\"Rating\",field:\"rating\",sort:\"asc\"},{label:\"User\",field:\"user\",sort:\"asc\"},{label:\"Comment\",field:\"comment\",sort:\"asc\"},{label:\"Actions\",field:\"actions\",sort:\"asc\"}],rows:reviews.map(r=>{var _r$user;return{id:r._id,rating:r.rating,user:((_r$user=r.user)===null||_r$user===void 0?void 0:_r$user.name)||\"Unknown\",comment:r.comment,actions:/*#__PURE__*/_jsx(Fragment,{children:/*#__PURE__*/_jsx(Button,{className:\"btn btn-danger btn-sm ml-2\",onClick:e=>deleteHandler(e,r._id),children:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-trash\"})})})};})};},[reviews]);return/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(MetaData,{title:\"Review List\"}),/*#__PURE__*/_jsx(\"div\",{className:\"col-12 col-md-2\",children:/*#__PURE__*/_jsx(Sidebar,{})}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-12 col-md-10\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"my-4\",children:\"Review List\"}),/*#__PURE__*/_jsx(\"div\",{className:\"row justify-content-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-5\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:onsubmithandler,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Product ID\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",onChange:e=>setproductid(e.target.value),value:productid,className:\"form-control\"})]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary btn-block py-2\",type:\"submit\",disabled:loading,children:\"Search\"})]})})}),/*#__PURE__*/_jsx(Fragment,{children:loading?/*#__PURE__*/_jsx(Loader,{}):/*#__PURE__*/_jsx(MDBDataTable,{data:data,bordered:true,striped:true,hover:true,className:\"px-3\"})})]})]});}","map":{"version":3,"names":["Fragment","useEffect","useMemo","useState","Button","useDispatch","useSelector","toast","MetaData","Loader","MDBDataTable","Sidebar","deleteReview","getReviews","cleardeleteerror","jsx","_jsx","jsxs","_jsxs","ReviewList","dispatch","productid","setproductid","reviews","loading","error","isreviewdeleted","state","productState","console","log","deleteHandler","e","id","target","disabled","position","success","onsubmithandler","preventDefault","trim","warn","data","columns","label","field","sort","rows","map","r","_r$user","_id","rating","user","name","comment","actions","children","className","onClick","title","onSubmit","type","onChange","value","bordered","striped","hover"],"sources":["/home/ashwin/Documents/GitHub/Ashcart/frontend/src/components/admin/reviewslist.js"],"sourcesContent":["import { Fragment, useEffect, useMemo, useState } from \"react\";\nimport { Button } from \"react-bootstrap\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { toast } from \"react-toastify\";\n\nimport MetaData from \"../layouts/MetaData\";\nimport Loader from \"../layouts/loader\";\nimport { MDBDataTable } from \"mdbreact\";\nimport Sidebar from \"./sidebar\";\n\nimport { deleteReview, getReviews } from \"../../actions/productsActions\";\nimport {\n  cleardeleteerror,\n} from \"../../slices/userSlices\"; // or productSlice if defined there\n\nexport default function ReviewList() {\n  const dispatch = useDispatch();\n  const [productid, setproductid] = useState(\"\");\n\n  const {\n    reviews = [],\n    loading,\n    error,\n    isreviewdeleted,\n  } = useSelector((state) => state.productState);\n  console.log(reviews); // full object\n\n\n  const deleteHandler = (e, id) => {\n    e.target.disabled = true;\n    dispatch(deleteReview(productid,id));\n  };\n\n  // Show error\n  useEffect(() => {\n    if (error) {\n      toast.error(error, { position: \"bottom-center\" });\n      dispatch(cleardeleteerror());\n    }\n  }, [error, dispatch]);\n\n  // Show success message\n  useEffect(() => {\n    if (isreviewdeleted) {\n      toast.success(\"Review Deleted Successfully!\", {\n        position: \"bottom-center\",\n      });\n      dispatch(cleardeleteerror());\n      dispatch(getReviews(productid)); // Refresh the reviews list\n    }\n  }, [isreviewdeleted, dispatch, productid]);\n\n  const onsubmithandler = (e) => {\n    e.preventDefault(); // ✅ fixed typo here\n    if (!productid.trim()) {\n      toast.warn(\"Please enter a product ID\", {\n        position: \"bottom-center\",\n      });\n      return;\n    }\n    dispatch(getReviews(productid));\n  };\n\n  const data = useMemo(() => {\n    return {\n      columns: [\n        { label: \"ID\", field: \"id\", sort: \"asc\" },\n        { label: \"Rating\", field: \"rating\", sort: \"asc\" },\n        { label: \"User\", field: \"user\", sort: \"asc\" },\n        { label: \"Comment\", field: \"comment\", sort: \"asc\" },\n        { label: \"Actions\", field: \"actions\", sort: \"asc\" },\n      ],\n      rows: reviews.map((r) => ({\n        id: r._id,\n        rating: r.rating,\n        user: r.user?.name || \"Unknown\",\n        comment: r.comment,\n        actions: (\n          <Fragment>\n            <Button\n              className=\"btn btn-danger btn-sm ml-2\"\n              onClick={(e) => deleteHandler(e, r._id)}\n            >\n                \n              <i className=\"fa fa-trash\"></i>\n            </Button>\n          </Fragment>\n        ),\n      })),\n    };\n  }, [reviews]);\n\n  return (\n    <div className=\"row\">\n      <MetaData title={\"Review List\"} />\n      <div className=\"col-12 col-md-2\">\n        <Sidebar />\n      </div>\n      <div className=\"col-12 col-md-10\">\n        <h1 className=\"my-4\">Review List</h1>\n        <div className=\"row justify-content-center\">\n          <div className=\"col-5\">\n            <form onSubmit={onsubmithandler}>\n              <div className=\"form-group\">\n                <label>Product ID</label>\n                <input\n                  type=\"text\"\n                  onChange={(e) => setproductid(e.target.value)}\n                  value={productid}\n                  className=\"form-control\"\n                />\n              </div>\n              <button\n                className=\"btn btn-primary btn-block py-2\"\n                type=\"submit\"\n                disabled={loading}\n              >\n                Search\n              </button>\n            </form>\n          </div>\n        </div>\n        <Fragment>\n          {loading ? (\n            <Loader />\n          ) : (\n            <MDBDataTable\n              data={data}\n              bordered\n              striped\n              hover\n              className=\"px-3\"\n            />\n          )}\n        </Fragment>\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}